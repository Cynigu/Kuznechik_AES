
# Кузнечик ( ГОСТ 34.12—2015 )

Ссылка на гост : https://tc26.ru/standard/gost/GOST_R_3412-2015.pdf

Ссылка на норм обучение : https://xakep.ru/2017/02/02/working-with-grasshopper/

Стандарт рекомендуется использовать при создании, эксплуатации и модернизации систем обработки информации различного назначения

Определения: 
- Блочный шифр - реализующий при каждом фиксированном значении ключа одно обратимое отображение множества блоков открытого текста фиксированной длины в блоки шифртекста такой же длины.
- Блок (block): Строка бит определенной длины.
- Итерационный ключ (round key): Последовательность символов, вычисляемая  в процессе развертывания ключа шифра, и определяющая преобразование на одной итерации блочного шифра.
- Ключ (key): Изменяемый параметр в виде последовательности символов, определяющий криптографическое преобразование.
- Развертывание ключа (key schedule): Вычисление итерационных ключей из ключа шифра.
- Симметричный криптографический метод (symmetric cryptographic technique): Криптографический метод, использующий один и тот же ключ для преобразования, осуществляемого отправителем, и  преобразования, осуществляемого получателем.
- SP — Substitution-Permutation network, или, по-русски, подстановочно-перестановочная сеть

# Шифрование
Шифр получает на вход ключ (мастер-ключ) и текст для зашифровки и совершает несколько чередующихся раундов, состоящих из стадий подстановки и стадий перестановки.
В «Кузнечике» каждый раунд включает в себя линейное и нелинейное преобразование плюс операцию наложения так называемого итерационного ключа. Всего таких раундов девять и один последний неполный раунд, в котором выполняется только наложение последнего (десятого) итерационного ключа.

![image](https://user-images.githubusercontent.com/56064826/202936674-5c24c214-f8ea-4c52-9d1b-a4687001ac74.png)

## Преобразование исходных данных (ключ и текст) в удобоваримые для шифрования
1) Подгоняем исходный текст под валидное значение (так чтобы можно было разбить на блоки по 16 байт)

Если количество байт текста не кратно 16 (количество блоков), то дополняем текст 0x01 байтом и 0x00 байтами пока кол-во байт не будет кратно 16

2) Первая пара раундовых (итерационных ключей) ключей

Разбиваем мастер-ключ на 2 ключа по 16 байт, если кол-во байт не кратно 16 в одном из ключей то дополняем 0x01 байтом и 0x00 байтами пока ключ не будет кратен 16
